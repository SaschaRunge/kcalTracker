#TODO: move validation logic out of data.py